<div class="actions-bar">
  <div class="send-request">
    <button
      nz-button
      nzType="primary"
      [disabled]="setOfCheckedId.size === 0"
      [nzLoading]="sendRequestIsloading"
      (click)="sendRequest()">
      Send Request
    </button>
    <span>Selected {{ setOfCheckedId.size }} items</span>
  </div>
  <div class="search-field-label">
    <span>Name:</span>
  </div>
  <div class="search-field-input">
    <input nz-input placeholder="Search text..." [(ngModel)]="firstName" type="string" />
  </div>
  <div class="search-field-button">
    <button
      nz-button
      nzType="primary"
      [disabled]="firstName.length === 0"
      [nzLoading]="loading"
      (click)="searchFirstName()">
      Search
    </button>
  </div>
</div>
<nz-table
  #usersTable
  nzShowPagination
  nzShowSizeChanger
  [nzData]="users"
  [nzFrontPagination]="false"
  [nzLoading]="loading"
  [nzPageIndex]="pageIndex"
  [nzPageSize]="pageSize"
  [nzTotal]="total"
  (nzQueryParams)="onQueryParamsChange($event)"
  nzTableLayout="fixed">
  <thead>
    <tr>
      <th
        [nzChecked]="checked"
        [nzIndeterminate]="indeterminate"
        nzLabel="Select all"
        (nzCheckedChange)="onAllChecked($event)"></th>
      <!-- <th nzColumnKey="firstName" [nzSortFn]="true">Name</th> -->
      <th nzColumnKey="firstName" [nzSortFn]="true" nzCustomFilter>
        Name
        <nz-filter-trigger [(nzVisible)]="visible" [nzActive]="searchValue.length > 0" [nzDropdownMenu]="menu">
          <nz-icon nzType="search" />
        </nz-filter-trigger>
      </th>
      <th nzColumnKey="dateOfBirth" [nzSortFn]="true">Date of birth</th>
      <th nzColumnKey="gender" [nzFilters]="filterGender" [nzFilterFn]="true">Gender</th>
      <th nzColumnKey="email">Email</th>
      <th nzColumnKey="phone">Phone</th>
      <th nzColumnKey="accountType" [nzFilters]="filterAccountType" [nzFilterFn]="true">Accout type</th>
    </tr>
  </thead>
  <tbody>
    @for (user of usersTable.data; track user.id) {
      <tr>
        <td
          [nzChecked]="setOfCheckedId.has(user.id)"
          [nzDisabled]="user.disabled"
          [nzLabel]="user.firstName"
          (nzCheckedChange)="onItemChecked(user.id, $event)"></td>
        <td>{{ user.firstName }}</td>
        <td>{{ user.dateOfBirth | date:'dd.MM.yyyy' }}</td>
        <td>{{ user.gender }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.phone }}</td>
        <td>{{ user.accountType }}</td>
      </tr>
    }
  </tbody>
</nz-table>
<nz-dropdown-menu #menu="nzDropdownMenu">
  <div class="ant-table-filter-dropdown">
    <div class="search-box">
      <input type="text" nz-input placeholder="Search name" [(ngModel)]="searchValue" />
      <button nz-button nzSize="small" nzType="primary" (click)="searchFirstName()" class="search-button">Search</button>
      <button nz-button nzSize="small" (click)="resetFirstName()">Reset</button>
    </div>
  </div>
</nz-dropdown-menu>
